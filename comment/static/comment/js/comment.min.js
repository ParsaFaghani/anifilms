function getCookie(e){let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let n=0;n<o.length;n++){const r=o[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}}return t}function load(element,url){let xmlhttp;xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===XMLHttpRequest.DONE)if(200===xmlhttp.status){element.innerHTML=xmlhttp.responseText;const allScripts=element.getElementsByTagName("script");for(let n=0;n<allScripts.length;n++)eval(allScripts[n].innerHTML)}else alert("Error")},xmlhttp.open("GET",url,!0),xmlhttp.send()}function LoadComment(e,t){load(document.querySelector(`#comment-${e}`),`/comment/detail?urlhash=${e}&settings_slug=${t}`)}function LoadCommentList(e=1,t=!1){let o=document.querySelector("#form-comment-create [name='app_name']").value,n=document.querySelector("#form-comment-create [name='model_name']").value,r=document.querySelector("#form-comment-create [name='object_id']").value,a=document.querySelector("#form-comment-create [name='settings_slug']").value,m=document.querySelector("#comment-list");load(m,`/comment/list?app_name=${o}&model_name=${n}&object_id=${r}&page=${e}&settings_slug=${a}`),t||(document.querySelector("html").style.scrollBehavior="smooth",window.scroll(0,m.offsetTop))}function LoadDeleteCommentForm(e){load(document.querySelector("#comment-modal"),`/comment/delete/${e}`)}function LoadCommentReactions(e){load(document.querySelector(`#form-comment-react-${e} #comment-react-list`),`/comment/react?urlhash=${e}`)}function ResetCreateCommentForm(){document.querySelector("#form-comment-create [name='content']").value="",document.querySelector("#form-comment-create [name='content']").style.height="124px",document.querySelector("#form-comment-create [name='is_spoiler']").checked=!1}function ResetEditCommentForm(e,t,o){let n=document.querySelector(`#${e} textarea`);n.value=t,n.classList.remove("animate-[pulse_500ms_linear_infinite]","border-textarea-border-empty-light","dark:border-textarea-border-empty-dark"),n.classList.add("border-textarea-bg-light","dark:border-textarea-bg-dark"),document.querySelector(`#${e} [name='is_spoiler']`).checked="True"===o}function ResetDeleteCommentForm(){document.querySelector("#comment-modal").innerHTML=""}function CreateComment(e,t){let o="True"===t,n=document.querySelector(`#${e}`),r=n.getAttribute("method"),a=n.getAttribute("action"),m={app_name:document.querySelector("#form-comment-create [name='app_name']").value,model_name:document.querySelector("#form-comment-create [name='model_name']").value,content_type:document.querySelector("#form-comment-create [name='content_type']").value,object_id:document.querySelector("#form-comment-create [name='object_id']").value,settings_slug:document.querySelector("#form-comment-create [name='settings_slug']").value,content:document.querySelector(`#${e} [name='content']`).value,is_spoiler:document.querySelector(`#${e} [name='is_spoiler']`).matches(":checked"),parent_id:document.querySelector(`#${e} [name='parent_id']`)?document.querySelector(`#${e} [name='parent_id']`).value:null},c=new XMLHttpRequest;c.open(r,a,!0),c.setRequestHeader("Content-type","application/json"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("X-CSRFToken",getCookie("csrftoken")),c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE)if(200===c.status)if(o&&document.getElementById("toast").classList.remove("hidden"),m.parent_id){LoadCommentList(document.querySelector(`#form-comment-reply-${m.parent_id} [name='page']`).value)}else ResetCreateCommentForm(),LoadCommentList();else{""!==document.querySelector(`#${e} textarea`).value.trim()&&alert("ERROR in Creating Comment!")}},c.send(JSON.stringify(m))}function CheckEditTextarea(e){let t=document.querySelector(`#${e} textarea`);""===t.value.trim()?(t.classList.remove("border-textarea-bg-light","dark:border-textarea-bg-dark"),t.classList.add("border-textarea-border-empty-light","dark:border-textarea-border-empty-dark")):(t.classList.remove("border-textarea-border-empty-light","dark:border-textarea-border-empty-dark","animate-[pulse_500ms_linear_infinite]"),t.classList.add("border-textarea-bg-light","dark:border-textarea-bg-dark"))}function EditComment(e,t,o){let n="True"===o,r=document.querySelector(`#${e}`),a=r.getAttribute("method"),m=r.getAttribute("action"),c={content:document.querySelector(`#${e} [name='content']`).value,is_spoiler:document.querySelector(`#${e} [name='is_spoiler']`).checked,urlhash:e.replace("form-comment-edit-",""),settings_slug:t},s=new XMLHttpRequest;s.open(a,m,!0),s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-CSRFToken",getCookie("csrftoken")),s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)n&&s.response&&document.getElementById("toast").classList.remove("hidden"),LoadComment(c.urlhash,t);else{let t=document.querySelector(`#${e} textarea`);""===t.value.trim()?(t.classList.remove("border-textarea-bg-light","dark:border-textarea-bg-dark"),t.classList.add("animate-[pulse_500ms_linear_infinite]","border-textarea-border-empty-light","dark:border-textarea-border-empty-dark")):alert("ERROR in Creating Comment!")}},s.send(JSON.stringify(c))}function DeleteComment(e){let t=document.querySelector(`#form-comment-delete-${e}`),o=t.getAttribute("method"),n=t.getAttribute("action"),r=new XMLHttpRequest;r.open(o,n,!0),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("X-CSRFToken",getCookie("csrftoken")),r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&(200===r.status?(ResetDeleteCommentForm(),LoadCommentList()):alert("ERROR in Deleting Comment!"))},r.send()}function ReactComment(e,t){let o=document.querySelector(`#form-comment-react-${e}`),n=o.getAttribute("method"),r=o.getAttribute("action"),a={urlhash:e,react_slug:t},m=new XMLHttpRequest;m.open(n,r,!0),m.setRequestHeader("Content-type","application/json"),m.setRequestHeader("X-Requested-With","XMLHttpRequest"),m.setRequestHeader("X-CSRFToken",getCookie("csrftoken")),m.onreadystatechange=function(){m.readyState===XMLHttpRequest.DONE&&200===m.status&&LoadCommentReactions(e)},m.send(JSON.stringify(a))}function CloseToast(){document.getElementById("toast").classList.add("hidden")}document.addEventListener("DOMContentLoaded",(()=>{LoadCommentList(void 0,!0)}));